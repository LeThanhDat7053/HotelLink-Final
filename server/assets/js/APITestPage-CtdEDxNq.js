import{a as d,p as w,j as e}from"./index-DCnlPv3J.js";import{b as o}from"./react-vendor-BarjVlvC.js";import{T as F,P as R,C as h,B as T,y as $,d as v,e as x,A as j,q as B,u as k,Q as E,U as b}from"./antd-vendor-zUgH_XO9.js";import"./axios-vendor-B9ygI19o.js";const C={async getCategories(t){const{data:s}=await d.get("/features/categories",{params:t});return s},async getCategoryById(t){const{data:s}=await d.get(`/features/categories/${t}`);return s},async getFeatures(t){const{data:s}=await d.get("/features/",{params:t});return s},async getFeatureById(t){const{data:s}=await d.get(`/features/${t}`);return s},async createFeature(t){const{data:s}=await d.post("/features/",t);return s},async updateFeature(t,s){const{data:i}=await d.put(`/features/${t}`,s);return i},async deleteFeature(t){await d.delete(`/features/${t}`)}},I={async getPosts(t){const{data:s}=await d.get("/posts/",{params:t});return s},async getPostById(t){const{data:s}=await d.get(`/posts/${t}`);return s},async createPost(t){const{data:s}=await d.post("/posts/",t);return s},async updatePost(t,s){const{data:i}=await d.put(`/posts/${t}`,s);return i},async deletePost(t){await d.delete(`/posts/${t}`)},async publishPost(t){const{data:s}=await d.post(`/posts/${t}/publish`);return s},async archivePost(t){const{data:s}=await d.post(`/posts/${t}/archive`);return s}};function _(t){const[s,i]=o.useState(null),[u,n]=o.useState(!0),[c,r]=o.useState(null);return o.useEffect(()=>{let a=!0;return(async()=>{try{n(!0);const g=await w.getPropertyByCode(t);a&&(i(g),r(null))}catch(g){a&&r(g)}finally{a&&n(!1)}})(),()=>{a=!1}},[t]),{property:s,loading:u,error:c}}function H(t){const[s,i]=o.useState([]),[u,n]=o.useState(!0),[c,r]=o.useState(null);return o.useEffect(()=>{let a=!0;return(async()=>{try{n(!0);const g=await C.getFeatures({category_id:t,include_system:!0});a&&(i(g),r(null))}catch(g){a&&r(g)}finally{a&&n(!1)}})(),()=>{a=!1}},[t]),{features:s,loading:u,error:c,refetch:()=>{}}}function A(){const[t,s]=o.useState([]),[i,u]=o.useState(!0),[n,c]=o.useState(null);return o.useEffect(()=>{let r=!0;return(async()=>{try{u(!0);const l=await C.getCategories({include_system:!0});r&&(s(l),c(null))}catch(l){r&&c(l)}finally{r&&u(!1)}})(),()=>{r=!1}},[]),{categories:t,loading:i,error:n}}function L(t,s){const[i,u]=o.useState([]),[n,c]=o.useState(!0),[r,a]=o.useState(null);return o.useEffect(()=>{if(!t){c(!1);return}let l=!0;return(async()=>{try{c(!0);const P=(await I.getPosts({property_id:t,feature_id:s,status:"PUBLISHED"})).filter(m=>m.vr360_url);l&&(u(P),a(null))}catch(p){l&&a(p)}finally{l&&c(!1)}})(),()=>{l=!1}},[t,s]),{posts:i,loading:n,error:r}}const{Title:S,Text:f,Paragraph:y}=F;function V(){const[t,s]=o.useState([]),[i,u]=o.useState(!1),n="royalhvt",c=async()=>{u(!0);const r=[];try{const a=await w.getPropertyByCode(n);r.push({test:"Get Property by Code",endpoint:`/properties/by-code/${n}`,status:"success",data:a})}catch(a){r.push({test:"Get Property by Code",endpoint:`/properties/by-code/${n}`,status:"error",error:a.message})}try{const{data:a}=await fetch("https://travel.link360.vn/api/v1/features/categories?include_system=true",{headers:{"x-tenant-code":"royalhvt"}}).then(l=>l.json());r.push({test:"Get Feature Categories",endpoint:"/features/categories",status:"success",data:a||[]})}catch(a){r.push({test:"Get Feature Categories",endpoint:"/features/categories",status:"error",error:a.message})}s(r),u(!1)};return o.useEffect(()=>{c()},[]),e.jsxs("div",{style:{padding:"40px",maxWidth:1200,margin:"0 auto"},children:[e.jsxs(S,{level:2,children:[e.jsx(R,{})," API Connection Test"]}),e.jsxs(h,{style:{marginBottom:24},children:[e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"Backend:"})," ","https://travel.link360.vn/api/v1"]}),e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"Tenant:"})," ","royalhvt"]}),e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"Property Code:"})," ",n]}),e.jsx(T,{type:"primary",icon:e.jsx($,{}),onClick:c,loading:i,children:"Re-test Connection"})]}),e.jsx(v,{}),i&&e.jsxs("div",{style:{textAlign:"center",padding:40},children:[e.jsx(x,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:"Testing API endpoints..."})]}),!i&&t.map((r,a)=>e.jsxs(h,{style:{marginBottom:16},title:e.jsxs("span",{children:[r.status==="success"?e.jsx(k,{style:{color:"#52c41a",marginRight:8}}):e.jsx(E,{style:{color:"#ff4d4f",marginRight:8}}),r.test]}),extra:e.jsx(B,{color:r.status==="success"?"success":"error",children:r.status}),children:[e.jsx(y,{children:e.jsx(f,{code:!0,children:r.endpoint})}),r.status==="success"&&r.data&&e.jsxs("div",{children:[e.jsx(f,{strong:!0,children:"Response:"}),e.jsx("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,maxHeight:300,overflow:"auto"},children:JSON.stringify(r.data,null,2)})]}),r.status==="error"&&e.jsx(j,{title:"Error",message:r.error,type:"error",showIcon:!0})]},a)),e.jsx(v,{}),e.jsxs(S,{level:3,children:[e.jsx(b,{})," React Hooks Test"]}),e.jsx(N,{propertyCode:n})]})}function N({propertyCode:t}){const{property:s,loading:i,error:u}=_(t),{categories:n,loading:c,error:r}=A(),{features:a,loading:l,error:g}=H(),{posts:p,loading:P,error:m}=L(s?.id);return e.jsxs("div",{children:[e.jsxs(h,{title:"useProperty Hook",style:{marginBottom:16},children:[i&&e.jsx(x,{}),u&&e.jsx(j,{title:u.message,type:"error"}),s&&e.jsxs("div",{children:[e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"Name:"})," ",s.property_name]}),e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"Code:"})," ",s.code]}),e.jsxs(y,{children:[e.jsx(f,{strong:!0,children:"VR360 URL:"})," ",s.vr360_url||"N/A"]})]})]}),e.jsxs(h,{title:"useFeatureCategories Hook",style:{marginBottom:16},children:[c&&e.jsx(x,{}),r&&e.jsx(j,{title:r.message,type:"error"}),n&&e.jsxs("div",{children:[e.jsxs(f,{children:["Found ",n.length," categories"]}),e.jsx("pre",{style:{background:"#f5f5f5",padding:12,marginTop:8},children:JSON.stringify(n.slice(0,3),null,2)})]})]}),e.jsxs(h,{title:"useFeatures Hook",style:{marginBottom:16},children:[l&&e.jsx(x,{}),g&&e.jsx(j,{title:g.message,type:"error"}),a&&e.jsxs("div",{children:[e.jsxs(f,{children:["Found ",a.length," features"]}),e.jsx("pre",{style:{background:"#f5f5f5",padding:12,marginTop:8},children:JSON.stringify(a.slice(0,3),null,2)})]})]}),e.jsxs(h,{title:"useVR360Posts Hook",style:{marginBottom:16},children:[P&&e.jsx(x,{}),m&&e.jsx(j,{title:m.message,type:"error"}),p&&e.jsxs("div",{children:[e.jsxs(f,{strong:!0,style:{color:p.length>0?"#52c41a":"#ff4d4f"},children:["Found ",p.length," posts with VR360 URLs"]}),p.length>0&&e.jsx("pre",{style:{background:"#f5f5f5",padding:12,marginTop:8},children:JSON.stringify(p.slice(0,2),null,2)})]})]})]})}export{V as default};
